# DGX Spark AI Development Environment
# Generated for NGC PyTorch container

services:
  pytorch:
    image: nvcr.io/nvidia/pytorch:25.11-py3
    container_name: dgx-spark-pytorch

    # GPU access
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

    # Volume mounts
    volumes:
      - /home/trosfy/workspace:/workspace
      - /home/trosfy/.cache/huggingface:/root/.cache/huggingface
      - /home/trosfy/.cache/torch:/root/.cache/torch

    # Networking
    ports:
      - "8888:8888"   # Jupyter Lab
      - "6006:6006"   # TensorBoard

    # Required for PyTorch DataLoader
    ipc: host

    # Keep container running
    stdin_open: true
    tty: true

    # Working directory
    working_dir: /workspace

    # Default command (can override)
    command: jupyter lab --ip=0.0.0.0 --port=8888 --allow-root --no-browser
